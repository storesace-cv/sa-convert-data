<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>sa-convert-data</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>sa-convert-data</h1>
    <p>Modo: <strong id="mode-label">Idle</strong></p>
  </header>

  <main>
    <section class="card card-wide dashboard-card">
      <h2>Dashboard PyWebView</h2>
      <p class="hint">Indicadores de aprendizagem, regras e QA gerados em tempo real.</p>
      <div class="dashboard-frame-wrapper">
        <iframe
          id="learning-dashboard-frame"
          title="Dashboard de aprendizagem"
          src="about:blank"
          loading="lazy"
        ></iframe>
        <p id="dashboard-status" class="hint" hidden></p>
      </div>
    </section>

    <section class="card">
      <h2>Modo Aprendizagem</h2>
      <p>Importa <code>ingredientes - aprendizagem.xlsx</code> (sem exportar).</p>
      <div class="row">
        <label>Scope:</label>
        <input id="scope" value="global" />
      </div>
      <div class="row file-row">
        <label>Ficheiro:</label>
        <div class="file-input">
          <input id="learn-path" placeholder="/caminho/ingredientes - aprendizagem.xlsx" />
          <button type="button" class="secondary" data-file-target="learn-path" data-file-type="excel">Escolher…</button>
        </div>
      </div>
      <div class="button-row">
        <button id="btn-learn">Executar aprendizagem</button>
        <button id="btn-forget-learning" class="danger">Esquecer aprendizagem</button>
      </div>
      <pre id="learn-log"></pre>
    </section>

    <section class="card">
      <h2>Importar Cardex</h2>
      <div class="row">
        <label>Batch ID:</label>
        <input id="batch-id" placeholder="ex: 2024-07" />
      </div>
      <div class="row file-row">
        <label>Ficheiro:</label>
        <div class="file-input">
          <input id="cardex-path" placeholder="/caminho/cardex.xlsx" />
          <button type="button" class="secondary" data-file-target="cardex-path" data-file-type="excel">Escolher…</button>
        </div>
      </div>
      <button id="btn-import">Importar</button>
      <pre id="import-log"></pre>
    </section>

    <section class="card">
      <h2>Clustering</h2>
      <div class="row">
        <label>Threshold t1:</label>
        <input id="threshold-1" type="number" value="0.85" step="0.01" />
      </div>
      <div class="row">
        <label>Threshold t2:</label>
        <input id="threshold-2" type="number" value="0.92" step="0.01" />
      </div>
      <p class="hint">t1 define quando dois artigos ficam ligados. t2 marca seleções automáticas.</p>
      <button id="btn-cluster">Propor clusters</button>
      <pre id="cluster-log"></pre>
    </section>

    <section class="card card-wide">
      <h2>Revisão &amp; aprovação</h2>
      <p>Seleciona os membros relevantes e aprova o cluster para gerar o artigo canónico.</p>
      <div class="review-actions">
        <button id="btn-refresh-clusters">Atualizar clusters</button>
      </div>
      <div id="clusters-area" class="clusters-area">
        <p class="empty">Sem clusters carregados.</p>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
